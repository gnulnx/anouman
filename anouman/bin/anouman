#!/usr/bin/env bash

USER=`whoami`
if [ $USER == 'root' ];
then
    echo "You need to run this as a normal mode user"
    exit
fi

if [[ "$@" == *--deploy* ]]
then
    # TODO:  Do you really want to change to the users home directory?
    #cd ~/

    if [ ! -d "~/.virtualenvs/anouman" ]; then
        echo "Setting up anouman an server"

        echo "Install virtualwrapper"
        sudo pip install virtualenvwrapper -q
        source /usr/local/bin/virtualenvwrapper.sh;

        echo "Setting up anouman virtualenv"
        mkvirtualenv anouman;
        workon anouman;

        echo "Installing django into anouman virtualenv"
        pip install django -q

        ~/.virtualenvs/anouman/bin/pip install /vagrant/anouman-0.0.4.0.tar.gz --upgrade
        ## TODO  pip install anouman
        #pip install anouman  --upgrade -q
    
        echo "anouman basic setup now finished"
        
    fi
fi

if [ $1 ];
then
    echo "calling anouman-admin.py $@"
    anouman-admin.py $@
fi
